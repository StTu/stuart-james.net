<!DOCTYPE HTML>
<!--
	Future Imperfect by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
  <title>Stuart James' Journal</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--[if lte IE 8]><script src="js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" href="/css/main.css">
  <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
  <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
</head>

	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
<header id="header">
  <h1><a href="http://stuart-james.net">Stuart James' Journal</a></h1>
	<nav class="links">
    <!--
    <ul>
      <li><a href="#">Lorem</a></li>
			<li><a href="#">Ipsum</a></li>
			<li><a href="#">Feugiat</a></li>
			<li><a href="#">Tempus</a></li>
			<li><a href="#">Adipiscing</a></li>
		</ul>
  -->
	</nav>
	<nav class="main">
    <ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="search" method="get" action="#">
										<input type="text" name="query" placeholder="Search" />
									</form>
								</li>

		  

                    <li class="menu">
		  	<a class="fa-bars" href="#menu">Menu</a>
			</li>
		</ul>
	</nav>
</header>

<!-- Menu -->
<section id="menu">
  <!-- Search -->
  <!--
  <section>
	  <form class="search" method="get" action="#">
	    <input type="text" name="query" placeholder="Search" />
		</form>
	</section>
  -->
	<!-- Links -->
	<section>
	  <ul class="links">
	    <li>
                    <li>
                        <a class="" href="http://stuartjames.info">About</a>
                    </li>
                    <li>
                        <a class="" href="http://stuart-james.net">Blog</a>
                    </li>
                    <li>
                        <a class="" href="/Publications">Research</a>
                    </li>
                    <li>
                        <a class="" href="http://stuartjames.info/contact.aspx">Contact</a>
                    </li>
    </ul>
	</section>
	<!-- Actions -->
  <!--
  <section>
	  <ul class="actions vertical">
	    <li><a href="#" class="button big fit">Log In</a></li>
    </ul>
  </section>
  -->
</section>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
            <article class="post">
              <header>
                <div class="title">
                  <h2><a href="/2012/11/17/boost-serialization-for-inherited-objects.html">Boost Serialization for inherited objects</a></h2>
                <!-- <p>Lorem ipsum dolor amet nullam consequat etiam feugiat</p> -->
                </div>
                <div class="meta">
                  <time class="published" datetime="2012-11-17">November 17, 2012</time>
                  
									<h6>Read time about 6  minutes</h6>

        <!--
        <a href="#" class="author"><span class="name">Jane Doe</span><img src="images/avatar.jpg" alt="" /></a>
        -->
                </div>
              </header>
              
              <p>Preface:</p> <p>When chatting with a colleague yesterday, I referenced a blog post I never actually wrote. So to remedy that here we go, how to use boost in the case of inheritance.</p> <p>How To:</p> <p>Inheritance in C++ is very important, a long with classes and templates I would say the most important triplet (of course inheritance cant exist without classes). As I mentioned in a previous blog post I found a new love of boost serialization allowing me to easily be able to save out my objects in binary,text or xml, but there is a spanner in the works when it comes to inheritance, this is due to the serializer not being able to know it has a parent or even what that parent is.This is actually solved with a small amount additional of code but is critical to put in or your objects wont behave in the expected way.</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9D7513F9-C04C-4721-824A-2B34F0212519:b89b25f2-4794-4ac9-99e1-d0411e210bfe" class="wlWriterEditableSmartContent"><pre style=" width: 709px; height: 487px;background-color:White;overflow: hidden;"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;"> 1</span> <span style="color: #0000FF;">class</span><span style="color: #000000;"> MyParent {
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;"></span><span style="color: #0000FF;">public</span><span style="color: #000000;">:
</span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    MyParent() {};
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">virtual</span><span style="color: #000000;"> </span><span style="color: #000000;">~</span><span style="color: #000000;">MyParent() {};
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> getID(){ </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> ID;  } ;
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> setID(</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> num){ ID </span><span style="color: #000000;">=</span><span style="color: #000000;"> num;  } ;
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;"></span><span style="color: #0000FF;">private</span><span style="color: #000000;">:
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> ID;
</span><span style="color: #008080;">10</span> <span style="color: #000000;">    friend </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> boost::serialization::access;
</span><span style="color: #008080;">11</span> <span style="color: #000000;">    template</span><span style="color: #000000;">&lt;</span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Archive</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> serialize(Archive</span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> ar,
</span><span style="color: #008080;">12</span> <span style="color: #000000;">        </span><span style="color: #0000FF;">const</span><span style="color: #000000;"> unsigned </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> version) {
</span><span style="color: #008080;">13</span> <span style="color: #000000;">            ar </span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> BOOST_SERIALIZATION_NVP(ID);
</span><span style="color: #008080;">14</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">15</span> <span style="color: #000000;">};
</span><span style="color: #008080;">16</span> <span style="color: #000000;">
</span><span style="color: #008080;">17</span> <span style="color: #000000;"></span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MyChild : </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> MyParent {
</span><span style="color: #008080;">18</span> <span style="color: #000000;"></span><span style="color: #0000FF;">public</span><span style="color: #000000;">:
</span><span style="color: #008080;">19</span> <span style="color: #000000;">    MyChild() {};
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    </span><span style="color: #000000;">~</span><span style="color: #000000;">MyChild() {};
</span><span style="color: #008080;">21</span> <span style="color: #000000;">
</span><span style="color: #008080;">22</span> <span style="color: #000000;"></span><span style="color: #0000FF;">private</span><span style="color: #000000;">:
</span><span style="color: #008080;">23</span> <span style="color: #000000;">    friend </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> boost::serialization::access;
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    template</span><span style="color: #000000;">&lt;</span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Archive</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> serialize(Archive</span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> ar,
</span><span style="color: #008080;">25</span> <span style="color: #000000;">        </span><span style="color: #0000FF;">const</span><span style="color: #000000;"> unsigned </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> version) {
</span><span style="color: #008080;">26</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">27</span> <span style="color: #000000;">};</span></div></pre><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>So we serialize out the child class and what do we get? Well actually it is very clean elegant empty file. Not what was intended, but with a small change to tell the compiler of the classes parent we are able to serialize out child classes and parents without a problem</p>
<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9D7513F9-C04C-4721-824A-2B34F0212519:4dd2414d-0b90-4e20-9584-2fb513379093" class="wlWriterEditableSmartContent"><pre style=" width: 709px; height: 43px;background-color:White;overflow: hidden;"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span> <span style="color: #000000;">ar </span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> boost::serialization::make_nvp(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">MyParent</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,
</span><span style="color: #008080;">2</span> <span style="color: #000000;">    boost::serialization::base_object</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">MyParent</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">(</span><span style="color: #000000;">*</span><span style="color: #0000FF;">this</span><span style="color: #000000;">))</span></div></pre><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>As you hopefully can see this tells the compiler what the object parent is and provides a reference to it so therefore you can serialize that out. Of course you can put this line at the beginning or end depending on how you want to structure your outputs, but to my brain coming first makes sense.</p>
<p>The final solution being:</p>
<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9D7513F9-C04C-4721-824A-2B34F0212519:afc26a73-55e3-420a-a29c-d5b689b3d069" class="wlWriterEditableSmartContent"><pre style=" width: 709px; height: 563px;background-color:White;overflow: hidden;"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;"> 1</span> <span style="color: #0000FF;">class</span><span style="color: #000000;"> MyParent {
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;"></span><span style="color: #0000FF;">public</span><span style="color: #000000;">:
</span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    MyParent() {};
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">virtual</span><span style="color: #000000;"> </span><span style="color: #000000;">~</span><span style="color: #000000;">MyParent() {};
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> getID(){ </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> ID;  } ;
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> setID(</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> num){ ID </span><span style="color: #000000;">=</span><span style="color: #000000;"> num;  } ;
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;"></span><span style="color: #0000FF;">private</span><span style="color: #000000;">:
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> ID;
</span><span style="color: #008080;">10</span> <span style="color: #000000;">    friend </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> boost::serialization::access;
</span><span style="color: #008080;">11</span> <span style="color: #000000;">    template</span><span style="color: #000000;">&lt;</span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Archive</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> serialize(Archive</span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> ar,
</span><span style="color: #008080;">12</span> <span style="color: #000000;">        </span><span style="color: #0000FF;">const</span><span style="color: #000000;"> unsigned </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> version) {
</span><span style="color: #008080;">13</span> <span style="color: #000000;">            ar </span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> BOOST_SERIALIZATION_NVP(ID);
</span><span style="color: #008080;">14</span> <span style="color: #000000;">
</span><span style="color: #008080;">15</span> <span style="color: #000000;">            
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">17</span> <span style="color: #000000;">};
</span><span style="color: #008080;">18</span> <span style="color: #000000;">
</span><span style="color: #008080;">19</span> <span style="color: #000000;"></span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MyChild : </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> MyParent {
</span><span style="color: #008080;">20</span> <span style="color: #000000;"></span><span style="color: #0000FF;">public</span><span style="color: #000000;">:
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    MyChild() {};
</span><span style="color: #008080;">22</span> <span style="color: #000000;">    </span><span style="color: #000000;">~</span><span style="color: #000000;">MyChild() {};
</span><span style="color: #008080;">23</span> <span style="color: #000000;">
</span><span style="color: #008080;">24</span> <span style="color: #000000;"></span><span style="color: #0000FF;">private</span><span style="color: #000000;">:
</span><span style="color: #008080;">25</span> <span style="color: #000000;">    friend </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> boost::serialization::access;
</span><span style="color: #008080;">26</span> <span style="color: #000000;">    template</span><span style="color: #000000;">&lt;</span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Archive</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> serialize(Archive</span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> ar,
</span><span style="color: #008080;">27</span> <span style="color: #000000;">        </span><span style="color: #0000FF;">const</span><span style="color: #000000;"> unsigned </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> version) {
</span><span style="color: #008080;">28</span> <span style="color: #000000;">            ar </span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> boost::serialization::make_nvp(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">MyParent</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,
</span><span style="color: #008080;">29</span> <span style="color: #000000;">                        boost::serialization::base_object</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">MyParent</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">(</span><span style="color: #000000;">*</span><span style="color: #0000FF;">this</span><span style="color: #000000;">))
</span><span style="color: #008080;">30</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">31</span> <span style="color: #000000;">};</span></div></pre><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div><br /><a href='http://stuartjames.info/Journal/boost-serialization-for-inherited-objects.aspx'>Stuart James</a>&nbsp;&nbsp;<a href='http://stuartjames.info/Journal/boost-serialization-for-inherited-objects.aspx'>...</a>

							<hr />
							
							
              <footer>
                <ul class="stats">
                
        <!--
        <li><a href="#">General</a></li>
        <li><a href="#" class="icon fa-heart">28</a></li>
        <li><a href="#" class="icon fa-comment">128</a></li>
        -->
                </ul>
              </footer>
           </article>
  					<ul class="actions pagination">
  					  
  	  				  <li><a href="/2012/10/12/asus-reason-you-may-not-want-to-purchase-one.html" class="button big previous">Previous Post</a></li>
  						
							
  						  <li><a href="/2012/12/25/alternative-boost-graph-construction-based-on-defining-edges-independently.html" class="button big next">Next Post</a></li>
  						
  					</ul>
					</div>

				<!-- Sidebar -->
					<section id="sidebar">

						<!-- Intro -->
						<section id="intro">
  
	<header>
    
    <h2>Stuart James' Journal</h2>
    
    <div style='float:left;'><a href="http://stuart-james.net" class="logo"><img src="/images/logo.jpg" alt="" /></a></div>
    <div style='float:left;'>
    <p>A simple little place for me to scribble down
	  my thoughts and help my terrible memory</p>
    </div>
    <div style='clear:left;'></div>
	  <hr />
	  <p>A little about me...</p>
		<p>I'm a <strong>Computer Vision</strong> and <strong>Machine learning</strong> researcher at <strong>UCL</strong>. Working in the VECG with
		Tim Weyrich. Previously from <strong>University of Surrey</strong>  where I completed a Post-Doc and PhD studies.</p>

	</header>
</section>


						<!-- Mini Posts -->
						<section>
  <div class="mini-posts">
    
      <article class="mini-post">
  	    <header>
  		    <h3><a href="/2016/06/23/getting-back-to-books.html">Getting back to books</a></h3>
		      <time class="published" datetime="2016-06-23">June 23, 2016</time>
						<!--<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>-->
			  </header>
        
          <a href="/2016/06/23/getting-back-to-books.html" class="image"><img src="/images/blog/2016-06-23-book.jpg" alt="" /></a>
        
		  </article>
									<!-- Mini Post -->
									  <!--
										<article class="mini-post">
											<header>
												<h3><a href="#">Vitae sed condimentum</a></h3>
												<time class="published" datetime="2015-10-20">October 20, 2015</time>
												<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>
											</header>
											<a href="#" class="image"><img src="/images/pic04.jpg" alt="" /></a>
										</article>
									-->
    
      <article class="mini-post">
  	    <header>
  		    <h3><a href="/2016/06/14/twenty-nine-going-on-thirty.html">29 going on 30</a></h3>
		      <time class="published" datetime="2016-06-14">June 14, 2016</time>
						<!--<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>-->
			  </header>
        
          <a href="/2016/06/14/twenty-nine-going-on-thirty.html" class="image"><img src="/images/blog/2016-06-14-birthday.jpg" alt="" /></a>
        
		  </article>
									<!-- Mini Post -->
									  <!--
										<article class="mini-post">
											<header>
												<h3><a href="#">Vitae sed condimentum</a></h3>
												<time class="published" datetime="2015-10-20">October 20, 2015</time>
												<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>
											</header>
											<a href="#" class="image"><img src="/images/pic04.jpg" alt="" /></a>
										</article>
									-->
    
      <article class="mini-post">
  	    <header>
  		    <h3><a href="/2016/04/20/working-with-british-library-dataset.html">Working with the British Library Dataset</a></h3>
		      <time class="published" datetime="2016-04-20">April 20, 2016</time>
						<!--<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>-->
			  </header>
        
          <a href="/2016/04/20/working-with-british-library-dataset.html" class="image"><img src="/images/blog/2016-04-20-header.jpg" alt="" /></a>
        
		  </article>
									<!-- Mini Post -->
									  <!--
										<article class="mini-post">
											<header>
												<h3><a href="#">Vitae sed condimentum</a></h3>
												<time class="published" datetime="2015-10-20">October 20, 2015</time>
												<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>
											</header>
											<a href="#" class="image"><img src="/images/pic04.jpg" alt="" /></a>
										</article>
									-->
    
      <article class="mini-post">
  	    <header>
  		    <h3><a href="/2016/04/14/moving-to-jekyll.html">Moving to Jekyll</a></h3>
		      <time class="published" datetime="2016-04-14">April 14, 2016</time>
						<!--<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>-->
			  </header>
        
          <a href="/2016/04/14/moving-to-jekyll.html" class="image"><img src="/images/blog/jekyll-logo.png" alt="" /></a>
        
		  </article>
									<!-- Mini Post -->
									  <!--
										<article class="mini-post">
											<header>
												<h3><a href="#">Vitae sed condimentum</a></h3>
												<time class="published" datetime="2015-10-20">October 20, 2015</time>
												<a href="#" class="author"><img src="/images/avatar.jpg" alt="" /></a>
											</header>
											<a href="#" class="image"><img src="/images/pic04.jpg" alt="" /></a>
										</article>
									-->
    
  </div>
</section>


						<!-- Posts List -->


						<!-- Footer -->
						<section id="footer">
  <ul class="icons">
  	<li><a href="https://twitter.com/sttujames" class="fa-twitter"><span class="label">Twitter</span></a></li>
		<li><a href="https://github.com/sttu" class="fa-github"><span class="label">GitHub</span></a></li>
		<li><a href="/feed.xml" class="fa-rss"><span class="label">RSS</span></a></li>
		<li><a href="mailto:contact@stuart-james.com" class="fa-envelope"><span class="label">Email</span></a></li>
	</ul>
  <p class="copyright">Copyright &copy; 2016 </p>
   <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-7794553-4', 'auto');
      ga('send', 'pageview');

    </script>
</section>

					</section>
			</div>
		<!-- Scripts -->
		<script src="/js/jquery.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
<script src="/js/main.js"></script>

	</body>
</html>
